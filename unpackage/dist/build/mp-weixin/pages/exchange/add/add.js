(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/exchange/add/add"],{"1d4e":function(t,e,s){"use strict";(function(t){e.__esModule=!0,e["default"]={data:function(){return{order_noSearch:"",customer_nameSearch:"",uid:0,list:[],clientId:0,clientName:"",showClient:!1,clientList:[],showGood:!1,goodList:[],textGood:"",itemIndex:0,preventEvent:!1,page:1,pageShop:1,pageexpress:1,total:"",totalShop:"",username:"",date:"",order_no:"",checkedArr:[],allCheck:{name:"全选",value:"all",checked:!1},express_no:"",express_code:"",express_name:"",showExpress:!1,ExpressList:[],expressSearch:"",totalexpress:""}},mounted:function(){},onLoad:function(){var t=(new Date).toISOString();this.date=this.dateFormat(t),this.uid=this.common.get("uid")},methods:{changeDate:function(t){this.date=t},changeAll:function(t){console.log("changeAll",t);var e=t.detail.value;if("all"==e[0]){this.allCheck.checked=!0;for(var s=0,i=this.goodList;s<i.length;s++){var n=i[s],o=String(n.sales_detail_id);this.checkedArr.includes(o)||this.checkedArr.push(o)}}else this.allCheck.checked=!1,this.checkedArr=[]},changeCheck:function(t){this.checkedArr=t.detail.value,console.log("this.checkedArr",this.checkedArr),this.checkedArr.length>0&&this.checkedArr.length==this.goodList.length?this.allCheck.checked=!0:this.allCheck.checked=!1},noneEnoughPeople:function(){},dateFormat:function(t){var e=new Date(t),s=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate(),o=e.getHours()<10?"0"+e.getHours():e.getHours(),a=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),c=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return s+"-"+i+"-"+n+" "+o+":"+a+":"+c},clientInList:function(){var t=this;this.http({url:this.api.Returns_sales_list,method:"POST",data:{uid:this.common.get("uid"),customer_name:this.customer_nameSearch,order_no:this.order_noSearch,page:this.page-1,length:20},success:function(e){t.clientList=e.list,t.total=e.total}})},selectClient:function(t){this.clientId=this.clientList[t].id,this.clientName=this.clientList[t].order_no,this.showClient=!1,this.preventEvent=!1,this.page=1},selectExpress:function(t){this.express_name=this.ExpressList[t].name,this.express_code=this.ExpressList[t].comCode,this.showExpress=!1,this.preventEvent=!1,this.pageexpress=1},searchClient:function(){this.clientInList()},handlePage:function(t){this.page=t.current,this.clientInList()},handlePageShop:function(t){this.pageShop=t.current,this.shopList()},handlePageExpress:function(t){this.pageexpress=t.current,this.expressList()},shopList:function(){var t=this;this.http({url:this.api.Returns_sales_goods_list,method:"POST",data:{uid:this.uid,sales_id:this.clientId,page:this.pageShop-1,length:20},success:function(e){t.goodList=e.list,t.totalShop=e.total}})},searchGood:function(t){this.shopList()},openModal:function(e){this.preventEvent=!0,"client"==e?(this.showClient=!0,this.clientInList()):"good"==e?""==this.clientId?t.showToast({title:"请先选择销售单",icon:"none",duration:2e3}):(this.showGood=!0,this.shopList()):(this.showExpress=!0,this.expressList())},searchexpress:function(){this.expressList()},expressList:function(){var t=this;this.http({url:this.api.Common_express_list,method:"POST",data:{uid:this.uid,name:this.expressSearch,page:this.pageexpress-1,length:20},success:function(e){t.ExpressList=e.list,t.totalexpress=e.total}})},closeModal:function(t){this.preventEvent=!1,"client"==t?this.showClient=!1:"good"==t&&(this.showGood=!1),this.page=1,this.pageShop=1,this.checkedArr=[]},selectGood:function(){var t=this;this.http({url:this.api.Returns_get_sales_goods_by_id,method:"POST",data:{uid:this.uid,id:this.checkedArr},success:function(e){e.map((function(e,s){t.list.push(e)}))}}),console.log("this.list",this.list)},close:function(){this.preventEvent=!1},del:function(t){this.list.splice(t,1)},num:function(t,e){var s=t.target.value,i=/[^\d]/g;this.list[e].countReturn=s.replace(i,"")},express:function(t){var e=this;this.express_no=t.detail.value,this.http({url:this.api.Common_auto_express,method:"POST",data:{uid:this.uid,express_no:t.detail.value},success:function(t){e.express_name=t.name,e.express_code=t.comCode}})},updatePriceArr:function(){for(var t=[],e=0;e<this.list.length;e++)0!=this.list[e].id&&t.push(this.list[e]);return t},previous:function(){var e=getCurrentPages(),s=e[e.length-2];t.navigateBack({success:function(){s.onLoad()}})},submit:function(){var e=this,s=[];this.list.map((function(t,e){s.push({sales_detail_id:t.id,count:t.countReturn,remark:t.remark})})),t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Change_submit,method:"POST",data:{uid:e.uid,date:e.date,order_no:e.order_no,sales_id:e.clientId,express_no:e.express_no,express_code:e.express_code,express_name:e.express_name,total_data:JSON.stringify(s)},success:function(s){t.showToast({title:"操作成功",icon:"none",duration:2e3}),setTimeout((function(){e.previous()}),500)}})},fail:function(){},complete:function(){}})}}}}).call(this,s("d5d0")["default"])},2226:function(t,e,s){"use strict";(function(t){s("4381");i(s("dc04"));var e=i(s("71fa"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=s,t(e.default)}).call(this,s("97ff")["createPage"])},"68c6":function(t,e,s){},"71fa":function(t,e,s){"use strict";s.r(e);var i=s("f56b"),n=s("ddfb");for(var o in n)"default"!==o&&function(t){s.d(e,t,(function(){return n[t]}))}(o);s("9754");var a,c=s("f0c5"),r=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=r.exports},9754:function(t,e,s){"use strict";var i=s("68c6"),n=s.n(i);n.a},ddfb:function(t,e,s){"use strict";s.r(e);var i=s("1d4e"),n=s.n(i);for(var o in i)"default"!==o&&function(t){s.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},f56b:function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){return i}));var i={uniEasyinput:function(){return s.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(s.bind(null,"a715"))},uniDatetimePicker:function(){return Promise.all([s.e("common/vendor"),s.e("uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker")]).then(s.bind(null,"1a41"))},uniPagination:function(){return Promise.all([s.e("common/vendor"),s.e("uni_modules/uni-pagination/components/uni-pagination/uni-pagination")]).then(s.bind(null,"c835"))}},n=function(){var t=this,e=t.$createElement,s=(t._self._c,t.__map(t.goodList,(function(e,s){var i=t.__get_orig(e),n=t.checkedArr.includes(String(e.sales_detail_id));return{$orig:i,g0:n}})));t.$mp.data=Object.assign({},{$root:{l0:s}})},o=[]}},[["2226","common/runtime","common/vendor"]]]);